<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
      integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../styles.css" />
    <link rel="icon" type="image/png" href="../images/everyone.svg" />
    <title>Inclusive development</title>
    <script src="../retrieveSettings.js"></script>
  </head>

  <nav>
    <ul role="navigation">
      <li tabindex="0" class="key-nav" id="skip_to_content">
        <a href="#main_content">Skip to main content</a>
      </li>
      <li tabindex="0" class="key-nav">
        <a href="/">Home </a><i class="fas fa-home" aria-hidden="true"></i>
      </li>
      <li tabindex="0" class="key-nav">
        <a href="../pages/about.html">About me </a
        ><i class="far fa-address-card" aria-hidden="true"></i>
      </li>
      <li tabindex="0" class="key-nav" id="current_page">
        <a href="../pages/inclusive.html" aria-current="page"
          >Inclusive development </a
        ><i class="fas fa-user-check" aria-hidden="true"></i>
      </li>
      <li tabindex="0" class="key-nav">
        <a href="../pages/tools.html">Digital health </a
        ><i class="fas fa-spa" aria-hidden="true"></i>
      </li>
      <li tabindex="0" class="key-nav">
        <a href="../pages/settings.html">Settings </a
        ><i class="fas fa-cog" aria-hidden="true"></i>
      </li>
    </ul>
  </nav>

  <body>
    <section class="banner">
      <h1>Inclusive development</h1>
    </section>
    <div class="inclusive-container fade-in-content">
      <h2 id="main_content">Important factors:</h2>
      <div class="factor-container">
        <a href="#digital-section" class="inclusive-link"
          ><div class="digital-inclusion" tabindex="0">
            <header>Digital inclusion</header>
            <img
              src="../images/digi.svg"
              class="factor-img"
              id="digi_icon"
              alt="digital inclusion icon"
            /></div
        ></a>
        <a href="#visual-section" class="inclusive-link">
          <div class="visual-impairment" tabindex="0">
            <header>Visual Impairment</header>
            <img
              src="../images/visual.svg"
              class="factor-img"
              id="visual_icon"
              alt="visual impairment icon"
            /></div
        ></a>
        <a href="#neuro-section" class="inclusive-link"
          ><div class="neuro-diversity" tabindex="0">
            <header>Neurodiversity</header>
            <img
              src="../images/neuro.svg"
              class="factor-img"
              id="neuro_icon"
              alt="neurodiversity icon"
            /></div
        ></a>
        <a href="#physical-section" class="inclusive-link"
          ><div class="physical-health-and-ability" tabindex="0">
            <header>Physical health and ability</header>
            <img
              src="../images/hand.svg"
              class="factor-img"
              id="hand_icon"
              alt="physical health and ability icon"
            /></div
        ></a>
        <a href="#language-section" class="inclusive-link"
          ><div class="language-area" tabindex="0">
            <header>Language</header>
            <img
              src="../images/language.svg"
              class="factor-img"
              id="language_icon"
              alt="language icon"
            /></div
        ></a>
        <a href="#community-section" class="inclusive-link"
          ><div class="community-diversity" tabindex="0">
            <header>Community diversity</header>
            <img
              src="../images/diversity.svg"
              class="factor-img"
              id="diversity_icon"
              alt="culural diversity icon"
            /></div
        ></a>
      </div>

      <section id="digital-section" tabindex="0" class="hidden fade-in-content">
        <h3>Digital inclusion</h3>
        <p>
          Digital inclusion involves making your application accessible to
          people who lack confidence online and do not have advanced digital
          skills, or users that don't have access to the latest devices,
          up-to-date browsers or fast internet speeds.
        </p>
        <p>
          The key to digitial inclusion is ensuring that using your application
          is an intuitive, frustration free experience, everything is where you
          would expect it to be and important features are at the surface rather
          than deeply nested. Tutorials or walkthroughs can also be really
          helpful for new vistors.
        </p>
        <p>
          Designers sometimes use 'Personas' or user profiles to guide how
          things should look and feel for their target audience. I'm sure there
          are some specific use cases for this approach but here i'm going to
          turn the concept on it's head by presenting to you an inclusive
          persona generator so you can ask yourself whether your site really is
          accessible for all.
        </p>
        <button id="random_user_btn">Generate random user</button>
        <div class="user-container">
          <p id="user_properties"></p>
          <img id="dice" src="../images/1.svg" alt="dice roll animation" />
        </div>
        <button class="scroll-top">Scroll to top</button>
      </section>

      <section id="visual-section" tabindex="0" class="hidden fade-in-content">
        <h3>Visual impairment</h3>
        <p>
          Many people who visit your website will have a type of visual
          impairment or disturbance, this includes colour blindness, sight loss
          or partial sight. Web designs should convey their functionality to
          users with different types of colour vision deficiency or those who
          have difficulty seeing content with low contrast. Logical ordering,
          semantic HTML and descriptive 'alternative' text are an absolute must
          for screen readers.
        </p>

        <h4>Visual accessbility simulator</h4>
        <p>
          Use the buttons below to explore how differences in visual perception
          change the readability of the images. To check the accessibility of
          your own image, input the web URL into the input field or browse your
          device for an image. Then click "set image".
        </p>
        <form id="get_ImageUrl">
          <div>
            <label for="customUrl">Add your image URL:</label>
            <input type="url" id="customUrl" name="userImage" />
          </div>
          <label for="custom_upload">Or upload from device:</label>
          <input
            type="file"
            id="custom_upload"
            name="userUpload"
            accept="image/png, image/gif, image/jpeg"
          />
          <button type="submit">Set image</button>
        </form>

        <div class="colourB-container fade-in-content">
          <div class="filter-btn-container">
            <button
              data-filter="hue-rotate(35deg) saturate(60%) sepia(5%)"
              class="filter-btn"
            >
              Protanopia
            </button>
            <button data-filter="grayscale(80)" class="filter-btn">
              Achromatopsia
            </button>
            <button data-filter="blur(2px)" class="filter-btn">Blurry</button>
            <button data-filter="contrast(25%)" class="filter-btn">
              Low contrast
            </button>
            <button data-filter="sightLoss" class="filter-btn">
              Sight Loss
            </button>
            <button data-filter="none" class="filter-btn">Unaltered</button>
          </div>

          <div class="comparison-container">
            <figure>
              <img
                class="multi_coloured"
                class="colour-filter"
                id="cutomisable_Img"
                src="../images/vibes.png"
                alt="Easy read written in different fonts, styles and colours"
              />
            </figure>
            <figure>
              <img
                class="multi_coloured"
                class="colour-filter"
                src="../images/easy.png"
                alt="Easy read written in simple clear font  and colours"
              />
              <figcaption>
                Easy read? This image has a screen reader friendly figcaption
              </figcaption>
            </figure>
          </div>
        </div>
        <button class="scroll-top" tabindex="0">Scroll to top</button>
      </section>

      <section id="neuro-section" tabindex="0" class="hidden fade-in-content">
        <h3>Neurodiversity</h3>
        <p>
          Neurodiversity is a broad term that encourages everyone to acknowledge
          and understand that people process information differently. Sites
          should be built with accessible typography and colour themes by
          default. However, as the 'diversity' part of neurodiversity suggests,
          what is clear and readable for one person might be confusing or
          distracting to someone else. For instance some people might enjoy
          elaborate page transitions and movement on the page while others could
          find vibrant flashing animations uncomfortable or overwhelming.
        </p>
        <p>The solution is to offer choice.</p>
        <p>
          Giving people control over their experience is something that is
          typically limited to desktop applications but it doesn't have to be
          this way! Check out the options available for this site in
          <a href="./settings.html">Settings</a>.
        </p>
        <h4>Using session storage</h4>
        <p>
          CSS variables are fantastic for enabling instant style changes across
          an entire application. But what about if a user refreshes the page?
          Not a problem. When the settings are applied, i've created a series of
          functions that can store the CSS variable or CSS property in session
          storage (locally on your device). Another function called
          RetrieveSettings() is called whenvever app.js is run, which first
          checks for the existence of stored settings, and then sets the CSS
          variables and properites using setAttribute() and setProperty()
          thereby maintaining 'state' upon page refresh!
        </p>
        <script src="https://gist.github.com/duckRabbitPy/217780da9e881face4c3294b968d9ce6.js"></script>
        <button class="scroll-top">Scroll to top</button>
      </section>

      <section
        id="physical-section"
        tabindex="0"
        class="hidden fade-in-content"
      >
        <h3>Physical health and ability</h3>
        <p>
          An indvidual's physical health and ability will influence how they
          will browse the web and interact online. Many people navigate using
          the keyboard and will tab through the webpage instead of using the
          mouse. Others will navigate handsfree using a voice controller.
        </p>
        <p>
          I want to be a developer that ensures all core functionality is
          accessible via the keyboard and provides different styling when
          elements are keyboard focused. Reading up about accessibility options
          I came across creating a 'skip to main' link in the navigation bar
          which can save users from repetitive tabbing. Toggle more information
          to see how I built my accessible nav bar.
        </p>

        <h4>Building an accessible navbar:</h4>
        <p></p>
        <ol>
          <li class="nav-tut">
            To started off with I positioned 'a tags' within an unordered list
            and wrapped the code block in a semantic 'nav' element. Nav elements
            can help screen readers know when they are iterating through options
            in a menu. <br /><br />
            To help people with colour blindness, I ensured that a change in
            mouse hover state changes the border as well as the colour of the
            nav element. The aria="current" attribute tells screen readers what
            page they are on and i've also used it to set some unique styling
            for the current tab.
          </li>

          <li class="nav-tut">
            Next I gave each nav li element a tab index of 0, this means that if
            a visitor is on the page, they will be able to tab through the nav
            links.
          </li>

          <li class="nav-tut">
            Next I set the href of the 'skip to main content' to the
            #main_content id which is the location of the first piece of
            meaningful content on the page (outside the nav).
          </li>

          <li class="nav-tut">
            The opacacity of the skip link is set to 0 initially. focus:visible
            styling is applied when the li element has been keyboard focused
            making the skip link visible!
          </li>

          <li class="nav-tut">
            Finally there is the issue of navigating with the keyboard, on some
            screen readers there is no need for JavaScript because they
            recognise the "a" tags however it can be clunky, so to make sure I
            have added keydown event listeners, that listen for character 13
            which is the enter key. On 'enter' the event targets the element,
            and finds the child "a" tag and href. Window.location is used to
            then take the user to the page. I have used this keyboard safe
            approach with many other elements on my site.'
          </li>
        </ol>
        <p
          class="codepen"
          data-height="300"
          data-default-tab="html,result"
          data-slug-hash="QWvdpxE"
          data-user="duckrabbitpy"
          style="
            height: 300px;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid;
            margin: 1em 0;
            padding: 1em;
          "
        >
          <span
            >See the Pen
            <a href="https://codepen.io/duckrabbitpy/pen/QWvdpxE"> </a> by
            duckRabbitPy (<a href="https://codepen.io/duckrabbitpy"
              >@duckrabbitpy</a
            >) on <a href="https://codepen.io">CodePen</a>.</span
          >
        </p>
        <button class="scroll-top">Scroll to top</button>
      </section>

      <section
        id="language-section"
        tabindex="0"
        class="hidden fade-in-content"
      >
        <h3>Language</h3>
        <p>
          English is a very widely spoken language, but it's not the only one!
          Internationalisation (also known as i18n) is the practice of
          increasing the accessibility of your website by providing translation
          and country specific date, currency and measurement unit options.
          Translation can be achieved with JavaScript libraries or tools offered
          by external API's such as Google translate. At a very minimum web
          developers should write clear semantic html which will allow browser
          extensions or translation tools to work properly.
        </p>
        <p><b>Try using google translate!</b></p>
        <div id="google_translate_element"></div>
        <form id="analysis_form">
          <h4>Readability</h4>
          <p>
            It's also important to write in a way that is clear and easy to
            read. Long complex sentences with unfamiliar words can make your
            content inaccessible. I've built my own sentence analysis tool can
            indicate how readable your text is.
          </p>
          <textarea
            id="text_input"
            name="textInput"
            rows="10"
            cols="50"
          ></textarea>
          <button id="analyse_btn" type="submit">Analyse text</button>
          <p id="complexity_result">Result:</p>
        </form>
        <button class="scroll-top">Scroll to top</button>
      </section>

      <section
        id="community-section"
        tabindex="0"
        class="hidden fade-in-content"
      >
        <h3>Community diversity</h3>
        <p>
          One of the great things about the internet is that it brings an
          incredibly diverse community of people together from around the world.
          A successful web application could have thousands of people of
          different communities, genders, ethnicities, personal histories,
          identities and political struggles visiting the site every day.
        </p>
        <p>
          It's clear to me that people should have the opportunity to be
          actively involved in the development of the technology that they use
          and depend on. In my work at the McPin Foundation, the primary goal
          was to bring 'experts by experience' into mental health research, in
          the hope that by doing so the research will better serve the
          community. I'd like to continue this practice by being the type of
          developer that actively engages with the vast and diverse digital
          community in a meaningful and inclusive way through involvement and
          feedback.
        </p>
        <p>What do you think?</p>
        <p>
          This website has a 'flag for amendment' feature enabled, keyboard
          users if you select text and then <b>press '1'</b>,the selected text
          will be added to the feedback form below. Once you have flagged all of
          the content that you think could be improved, <b>tap '2'</b> twice to
          add your own comments.
        </p>
        <button class="scroll-top">Scroll to top</button>
      </section>
    </div>

    <footer>
      <p>
        <span><i id="github-icon" class="fab fa-github"></i></span>DuckRabbitPy
      </p>
    </footer>
    <script
      crossorigin="anonymous"
      src="https://polyfill.io/v3/polyfill.min.js?features=es2015%2Ces2016%2Ces2017%2Ces2018%2Ces2019%2Ces6%2Ces5"
    ></script>
    <script
      async
      src="https://cpwebassets.codepen.io/assets/embed/ei.js"
    ></script>
    <script src="../app.js"></script>
    <script>
      //page specific JavaScript
      //keep all selectors up top if possible
      const neuroSvg = document.getElementById("neuro_icon");
      const handSvg = document.getElementById("hand_icon");
      const languageSvg = document.getElementById("language_icon");
      const diversitySvg = document.getElementById("diversity_icon");
      const visualSvg = document.getElementById("visual_icon");
      const digitalSvg = document.getElementById("digi_icon");

      const randomUserBtn = document.getElementById("random_user_btn");
      const userProperties = document.getElementById("user_properties");

      const diceNumber = document.getElementById("dice");
      const options = document.querySelectorAll(".inclusive-link");

      const hiddenSections = document.querySelectorAll(".hidden");
      const showCodeBtn = document.querySelectorAll(".show-code");
      const asides = document.querySelectorAll(".example-aside");

      const filterBtns = document.querySelectorAll(".filter-btn");
      const multiCImg = document.querySelectorAll(".multi_coloured");
      const getImgBtn = document.getElementById("get_ImageUrl");
      const customUrl = document.getElementById("customUrl");
      const customImg = document.getElementById("cutomisable_Img");

      const customUpload = document.getElementById("custom_upload");

      const analyseForm = document.getElementById("analysis_form");
      const textInput = document.getElementById("text_input");
      const complexResult = document.getElementById("complexity_result");

      retrieveIconSvgTheme();

      //controls hiding and showing of sections
      options.forEach((option) => {
        option.addEventListener("click", (event) => {
          var x = event.x || event.clientX;
          var y = event.y || event.clientY;
          if (!x && !y) {
            //key event also emits a click event if element is in focus,
            //so need to check if 'true' mouse click
            //key event has co-ordinates 0,0
            return;
          } else {
            let parentClass = event.target.parentNode.className;
            let topic = parentClass.slice(0, parentClass.indexOf("-"));
            [...hiddenSections].forEach((elem) => {
              if (elem.id.includes(topic)) {
                elem.classList.remove("hidden");
                elem.classList.add("onShow");
              } else {
                elem.classList.remove("onShow");
                elem.classList.add("hidden");
              }
            });
          }
        });
      });

      //for keyboard users
      options.forEach((option) => {
        option.addEventListener("keydown", (event) => {
          if (event.keyCode === 13) {
            let inclusiveClass = event.target.className;
            let topic = inclusiveClass.slice(0, inclusiveClass.indexOf("-"));
            [...hiddenSections].forEach((elem) => {
              if (elem.id.includes(topic)) {
                elem.classList.remove("hidden");
                elem.classList.add("onShow");
              } else if (!elem.id.includes(topic)) {
                elem.classList.remove("onShow");
                elem.classList.add("hidden");
              }
            });
          }
        });
      });

      //theming with icons
      function retrieveIconSvgTheme() {
        let storedTheme = sessionStorage.getItem("storedColour");

        //think about if can be done by mapping over node list
        if (storedTheme === "dark-theme") {
          neuroSvg.src = "/images/neuroDarkTheme.svg";
          handSvg.src = "/images/handDarkTheme.svg";
          languageSvg.src = "/images/languageDarkTheme.svg";
          diversitySvg.src = "/images/diversityDarkTheme.svg";
          visualSvg.src = "/images/visualDarkTheme.svg";
          digitalSvg.src = "/images/digiDarkTheme.svg";
        } else {
          neuroSvg.src = "/images/neuro.svg";
          handSvg.src = "/images/hand.svg";
          languageSvg.src = "/images/language.svg";
          diversitySvg.src = "/images/diversity.svg";
          visualSvg.src = "/images/visual.svg";
          digitalSvg.src = "/images/digi.svg";
        }
      }

      [...filterBtns].forEach((elem) => {
        elem.addEventListener("click", (event) => {
          let filter = event.target.dataset.filter;
          if (filter === "sightLoss") {
            multiCImg.forEach((elem) => elem.classList.add("sightLoss"));
          } else {
            document.documentElement.style.setProperty(
              "--vision-filter",
              filter
            );
            multiCImg.forEach((elem) => elem.classList.remove("sightLoss"));
          }
        });
      });

      //dice roll 'animation'
      randomUserBtn.addEventListener("click", () => {
        setTimeout(() => {
          rollDice();
          setTimeout(() => {
            rollDice();
            setTimeout(() => {
              rollDice();
              createUser();
            }, 300);
          }, 300);
        }, 300);
      });

      function rollDice() {
        let num = Math.floor(Math.random() * 6 + 1);
        diceNumber.src = `../images/${num}.svg`;
      }

      //random user generator
      let user = {
        Name: "not set",
        Age: "not set",
        MainDevice: "not set",
        InternetSpeed: "not set",
        PreferredLanguage: "not set",
        CurrentlyLivingIn: "not set",
        AccessibilityConsideration: "not set",

        async randName() {
          let nameData = await fetchData("names");
          return nameData[Math.floor(Math.random() * nameData.length)]
            .first_name;
        },

        async randLanguage() {
          if (Math.random() > 0.3) {
            let languageData = await fetchData("language");
            return languageData[
              Math.floor(Math.random() * languageData.length)
            ];
          } else {
            return "English";
          }
        },

        async randCountry() {
          let countryData = await fetchData("countries");
          return countryData[Math.floor(Math.random() * countryData.length)]
            .name;
        },

        randAge() {
          this.Age = Math.floor(Math.random() * (110 - 12) + 12);
        },

        randInternetSpeed() {
          this.InternetSpeed = `${Math.floor(Math.random() * 150)} mb/s`;
        },

        randDevice() {
          const devices = [
            "cheap laptop",
            "high spec laptop",
            "macbook",
            "iphone",
            "android phone",
            "gaming PC",
            "old desktop computer",
            "android tablet",
            "ipad",
            "library computer",
          ];
          this.MainDevice = devices[Math.floor(Math.random() * devices.length)];
        },

        randAccessibility() {
          const considerations = [
            "partially sighted and uses screen reader to navigate",
            "dislikes flashing images",
            "struggles with font smaller than 16pt",
            "finds precise tasks with the mouse difficult",
            "has total hearing loss",
            "primarily uses keyboard to navigate",
            "appeciates high contrast when reading",
            "does not like bright screens",
            "needs more time when typing",
            "finds it hard to concentrate on large blocks of text",
          ];
          this.AccessibilityConsideration =
            considerations[Math.floor(Math.random() * considerations.length)];
        },
      };

      async function fetchData(dataField) {
        let data = await fetch(`../data/${dataField}.json`)
          .then((res) => res.json())
          .catch((err) => {
            throw err;
          });
        return data;
      }

      async function createUser() {
        //create new user object
        let newUser = Object.create(user);

        //call methods that need to collect json for their properties
        let name = await newUser.randName();
        let language = await newUser.randLanguage();
        let country = await newUser.randCountry();

        ////fire synchronous methods to set other properties
        newUser.randAge();
        newUser.randInternetSpeed();
        newUser.randDevice();
        newUser.randAccessibility();

        //once asynch data has been collected, set properties on user object
        newUser.Name = name;
        newUser.PreferredLanguage = language;
        newUser.CurrentlyLivingIn = country;

        userProperties.innerHTML = `<b>Name</b>: ${newUser.Name}
          <br> <b>Age</b>: ${newUser.Age}
          <br> <b>Currently in </b>: ${newUser.CurrentlyLivingIn}
          <br> <b>Preferred language </b>: ${newUser.PreferredLanguage} <br> <b>Main device</b>: ${newUser.MainDevice}
          <br> <b> Accessibility consideration </b>: ${newUser.AccessibilityConsideration}`;
      }

      getImgBtn.addEventListener("submit", (event) => {
        event.preventDefault();
        if (customUpload.value) {
          let localFileSrc = window.URL.createObjectURL(customUpload.files[0]);
          customImg.src = localFileSrc;
          //clear
          customUpload.value = "";
        } else if (customUrl.value) {
          let newSrc = customUrl.value;
          customImg.src = newSrc;
          //clear
          customUrl.value = "";
        }
      });

      analyseForm.addEventListener("submit", async function analyse(event) {
        event.preventDefault();
        let inputWords = textInput.value;
        let easyWordData = await fetchData("dale-chall");
        daleChall(inputWords, easyWordData);
      });

      //maybe include average sentence and word length too
      function daleChall(text, easyWords) {
        let textData = text;
        let numSentences = 1;
        text.includes(".")
          ? (numSentences = text.split(".").length)
          : (textData += ".");
        let sanitised = text.replace(/[^a-zA-Z\s]/g, "");
        let hardWords = 0;
        let numWords = 0;
        let adjustment = 0;
        let longWords = [];

        sanitised.split(" ").forEach((word) => {
          numWords++;
          if (!easyWords.includes(word.toLowerCase())) {
            hardWords++;
          }
          if (word.length > 10) {
            //only push if unique
            if (!longWords.includes(word.toLowerCase())) {
              longWords.push(word);
            }
          }
        });

        if (hardWords / numWords > 0.05) {
          adjustment = 3.6365;
        }

        let score = (
          0.1579 * ((hardWords / numWords) * 100) +
          0.0496 * (numWords / numSentences) +
          adjustment
        ).toFixed(1);

        let percentageHard = Math.floor((hardWords / numWords) * 100);

        let uniqueLongWords = longWords.filter((word) => word.upp);

        complexResult.innerHTML = `
        <b>Overall score: ${score}</b> <br><br>
        Number of words: ${numWords} <br><br>
        Long words: ${longWords} <br><br>
        Number of sentences: ${numSentences} <br><br>
        Number of not 'easy' words: ${hardWords} <br><br>
        Percentage not 'easy' words" ${percentageHard}%<br><br>
         `;
      }
    </script>
    <script
      type="text/javascript"
      src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"
    ></script>
  </body>
</html>
