<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
      integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../styles.css" />
    <link rel="icon" type="image/png" href="../images/everyone.svg" />
    <title>Digital health</title>
    <script src="../retrieveSettings.js"></script>
  </head>

  <nav>
      <ul>
        <li tabindex="0" class="key-nav" id="skip_to_content">
          <a href="#main_content">Skip to main content</a>
        </li>
        <li tabindex="0" class="key-nav">
          <a href="/">Home <i class="fas fa-home" aria-hidden="true"></i></a>
        </li>
        <li tabindex="0" class="key-nav">
          <a href="../pages/about.html">About me <i class="far fa-address-card" aria-hidden="true"></i></a
          >
        </li>
        <li tabindex="0" class="key-nav">
          <a href="../pages/inclusive.html">Inclusive development <i class="fas fa-user-check" aria-hidden="true"></i></a
          >
        </li>
        <li tabindex="0" class="key-nav" id="current_page">
          <a href="../pages/tools.html" aria-current="page"
            >Digital health <i class="fas fa-spa" aria-hidden="true"></i></a
          >
        </li>
        <li tabindex="0" class="key-nav" >
          <a href="../pages/settings.html" >Settings <i class="fas fa-cog" aria-hidden="true"></i></a
          >
        </li>
      </ul>
    </nav>

  <body>
    <section class="banner">
      <h1>Digital health</h1>
    </section>
      <div id="main_content" >
        <div class="health-app fade-in-content">

          <div class="view">

            <div class="digi-health-landing fade-in-content">
              <div id="health_landing_text">
              <h2>Welcome to digital health</h2>
              <p>Sometimes it's hard to know where to start when we're looking to improve or maintain our health.
                One approach is to start with the basics and build from there! This online tool will ask 5 questions
                spanning several key domains deemed crucial for health and wellbeing.
                <br><br>
                Use the slider or keyboard to provide a score of (worst possible) 1 up to 9 (best possible).
                <br><br>
                Once you have completed the brief questionaire you will be directed to a range of resources that might be useful
                based on your response.
              </p>
              <button id="start_quiz">Let's get started!</button>
            </div>
              
            <div>
              <img id="health_landing_img" src="../images/allDomains.svg" alt="picture showing 5 domains of health, mood, sleep, nutrition, social and exercise">
            </div>
            </div>


            <div class="mood-container domain hidden fade-in-content">
            <h3>How has your mood and wellbeing been this week? (Q1/5)</h3>
            <p>Use slider or press key 1 - 9 and hit 'Enter'</p>
            <div>
              <input type="range" id="mood_slider" class="slider" name="mood_slider"
                     min="1" max="9" step=1 value=5 list="mood_score">
                     <!-- datalist for accessibility -->
                     <datalist id="mood_score">
                       <option>1</option>
                       <option>2</option>
                       <option>3</option>
                       <option>4</option>
                       <option>5</option>
                       <option>6</option>
                       <option>7</option>
                       <option>8</option>
                       <option>9</option>
                     </datalist>
              <label for="mood_slider">Mood</label>
              <p class="slider-display" id="display_mood">Score: <b>5</b> (Ok)</p>
              <button class="next-btn">Next</button>
              <img class="domain-img" src="../images/mood.svg" alt="image of two people thinking, symbolising mood">
            </div>
            </div>

            <div class="sleep-container domain hidden fade-in-content">
                <h3>How have you been sleeping this week? (Q2/5)</h3>
                <p>Use slider or press key 1 - 9 and hit 'Enter'</p>
                <div>
                <input type="range" id="sleep_slider" class="slider" name="sleep_slider"
                       min="1" max="9" step=1 value=5 list="sleep_score">
                       <!-- datalist for accessibility -->
                      <datalist id="sleep_score">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                        <option>6</option>
                        <option>7</option>
                        <option>8</option>
                        <option>9</option>
                      </datalist>
                <label for="sleep_slider">Sleep</label>
                <p class="slider-display" id="display_sleep">Score: <b>5</b> (Ok)</p>
                <button class="next-btn">Next</button>
                <img class="domain-img" src="../images/owl.svg" alt="owl illustration symbolising of sleep">
              </div>
            </div>

            <div class="nutrition-container domain hidden fade-in-content">
              <h3>How has your diet and nutrition been this week? (Q3/5)</h3>
              <p>Use slider or press key 1 - 9 and hit 'Enter'</p>
              <div>
                <input type="range" id="nutrition_slider" class="slider" name="nutrition_slider"
                       min="1" max="9" step=1 value=5 list="nutrition_score">
                       <!-- datalist for accessibility -->
                      <datalist id="nutrition_score">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                        <option>6</option>
                        <option>7</option>
                        <option>8</option>
                        <option>9</option>
                      </datalist>
                <label for="nutrition_slider">Nutrition</label>
                <p class="slider-display" id="display_nutrition">Score: <b>5</b> (Ok)</p>
                <button class="next-btn">Next</button>
                <img class="domain-img" src="../images/nutrition.svg" alt="fruit and vegetables symbolising nutrition">
              </div>
            </div>

            <div class="social-container domain hidden fade-in-content">
              <h3>How socially active have you been this week? (Q4/5)</h3>
              <p>Use slider or press key 1 - 9 and hit 'Enter'</p>
              <div>
                <input type="range" id="social_slider" class="slider" name="social_slider"
                       min="1" max="9" step=1 value=5 list="social_score">
                       <!-- datalist for accessibility -->
                      <datalist id="social_score">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                        <option>6</option>
                        <option>7</option>
                        <option>8</option>
                        <option>9</option>
                      </datalist>
                <label for="social_slider">Sociability</label>
                <p class="slider-display" id="display_social">Score: <b>5</b> (Ok)</p>
                <button class="next-btn">Next</button>
                <img class="domain-img" src="../images/social.svg" alt="a group of friends symbolising sociability">
              </div>
            </div>

            <div class="exercise-container domain hidden fade-in-content">
              <h3>How fit and active have you been this week? (Q5/5)</h3>
              <p>Use slider or press key 1 - 9 and hit 'Enter'</p>
              <div>
                <input type="range" id="exercise_slider" class="slider" name="exercise_slider"
                       min="1" max="9" step=1 value=5 list="exercise_score">
                       <!-- datalist for accessibility -->
                      <datalist id="exercise_score">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                        <option>6</option>
                        <option>7</option>
                        <option>8</option>
                        <option>9</option>
                      </datalist>
                <label for="exercise_slider">Exercise</label>
                <p class="slider-display" id="display_exercise">Score: <b>5</b> (Ok)</p>
                <button class="next-btn">Next</button>
                <img class="domain-img" src="../images/exercise.svg" alt="a person running, symbolising exercise">
              </div>
            </div>

          <section class="dashboard-container fade-in-content hidden">
            <div class="result-container hidden">
              <h2>Digi health results </h2>
                <div class="bar-container">
                  <div>
                    <div tabindex="0" id="mood_result"></div>
                    <div id="mood_bar"></div>
                  </div>
                  <img id="mood_icon" class="positive_icon hidden" src="../images/positive.svg" alt="positive icon">
                </div>
                
                <div class="bar-container">
                  <div>
                    <div tabindex="0" id="sleep_result"></div>
                    <div id="sleep_bar"></div>
                  </div>
                    <img id="sleep_icon" class="positive_icon hidden" src="../images/positive.svg" alt="positive icon">
                </div>
                
                <div class="bar-container">
                  <div>
                    <div tabindex="0" id="nutrition_result"></div>
                    <div id="nutrition_bar"></div>
                  </div>
                    <img id="nutrition_icon" class="positive_icon hidden" src="../images/positive.svg" alt="positive icon">
                </div>
                
                <div class="bar-container">
                  <div>
                    <div tabindex="0" id="social_result"></div>
                    <div id="social_bar"></div>
                  </div>
                    <img id="social_icon" class="positive_icon hidden" src="../images/positive.svg" alt="positive icon">
                </div>
                
                <div class="bar-container">
                  <div>
                  <div tabindex="0" id="exercise_result"></div>
                  <div id="exercise_bar"></div>
                </div>
                  <img id="exercise_icon" class="positive_icon hidden" src="../images/positive.svg" alt="positive icon">
                </div>
              </div>
              
            </div>

            <div class="suggestions hidden">
              <h2>Suggestions</h2>
              <p id="high_scoring"></p>
              <p id="low_scoring"></p>
              
              
              <div id="mood_suggestions" class="hidden">
                <h3>Mood resources</h3>
                <ul class="suggestion-list">
                  <li class="suggestion-item"><a target="_blank" href="https://www.mind.org.uk/information-support/types-of-mental-health-problems/depression/self-care/">Low mood tips</a></li>
                  <li class="suggestion-item"><a target="_blank" href="https://www.nhs.uk/apps-library/catch-it/">Free CBT App</a></li>
                  <li class="suggestion-item"><a target="_blank" href="https://buddhify.com/">Mindfulness App</a></li>
                  <li class="suggestion-item"><a target="_blank" href="https://www.nhs.uk/mental-health/self-help/guides-tools-and-activities/mental-wellbeing-audio-guides/">Mental wellbeing audio guides</a></li>
                </ul>
              <iframe class="suggestion-vid" width="90%" height="300vh" src="https://www.youtube.com/embed/ytKCcYxUU04" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
              </div>

              <div id="sleep_suggestions" class="hidden">
                <h3>Sleep resources</h3>
                <ul class="suggestion-list">
                  <li class="suggestion-item"><a target="_blank" href="https://www.mentalhealth.org.uk/publications/how-sleep-better">How to sleep better</a></li>
                  <li class="suggestion-item"><a target="_blank" href="https://www.sleepfoundation.org/sleep-hygiene">Sleep Hygiene</a></li>
                  <li class="suggestion-item"><a target="_blank" href="https://pzizz.com/">Sleep App</a></li>
                </ul>
              <iframe class="suggestion-vid" width="90%" height="300vh" src="https://www.youtube.com/embed/t0kACis_dJE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
              </div>

              <div id="nutrition_suggestions" class="hidden">
                <h3>Nutrition resources</h3>
                <ul class="suggestion-list">
                  <li class="suggestion-item"><a target="_blank" href="https://www.bbcgoodfood.com/howto/guide/what-is-dash-diet">DASH diet</a></li>
                  <li class="suggestion-item"><a target="_blank" href="https://www.nhs.uk/live-well/eat-well/eight-tips-for-healthy-eating/">Healthy eating tips</a></li>
                  <li class="suggestion-item"><a target="_blank" href="https://play.google.com/store/apps/details?id=com.PHE.smartrecipes&hl=en_GB&gl=US">Easy Meals App</a></li>
                </ul>
                <iframe class="suggestion-vid" width="90%" height="300vh" src="https://www.youtube.com/embed/Uj8_Na-3YBA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
              </div>

              <div id="social_suggestions" class="hidden">
                <h3>Social connectedness resources</h3>
                <ul class="suggestion-list">
                  <li class="suggestion-item"><a target="_blank" href="https://www.betterup.com/blog/how-to-stay-socially-connected-to-society-your-life-depends-on-it">Staying connected</a></li>
                  <li class="suggestion-item"><a target="_blank" href="https://www.meetup.com/">Meet Up</a></li>
                  <li class="suggestion-item"><a target="_blank" href="https://www.seechum.com/">Social connection app</a></li>
                </ul>
                <iframe class="suggestion-vid" width="90%" height="300vh" src="https://www.youtube.com/embed/8az-gfljEbg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
              </div>

              <div id="exercise_suggestions" class="hidden">
                <h3>Exercise resources</h3>
                <ul class="suggestion-list">
                  <li class="suggestion-item"><a target="_blank" href="https://www.healthline.com/nutrition/10-benefits-of-exercise#TOC_TITLE_HDR_3">Benefits of exercise</a></li>
                  <li class="suggestion-item"><a target="_blank" href="https://www.nhs.uk/live-well/exercise/10-minute-workouts/">10 minute work outs</a></li>
                  <li class="suggestion-item"><a target="_blank" href="https://play.google.com/store/apps/details?id=com.phe.couchto5K">Couch to 5k app</a></li>
                </ul>
                <iframe class="suggestion-vid" width="90%" height="300vh" src="https://www.youtube.com/watch?v=G2HU4NJ_M3c" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
              </div>

            </div>

          </section>

          </div>
        </div>

      </div>
       
      </div>

      
    </div>
    <footer>
      <p>
        <span><i id="github-icon" class="fab fa-github"></i></span>DuckRabbitPy
      </p>
    </footer>
    <script crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?features=es2015%2Ces2016%2Ces2017%2Ces2018%2Ces2019%2Ces6%2Ces5"></script>
    <script type="text/javascript" src="../app.js"></script>
    <script
    type="text/javascript"
    src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"
  ></script>
  <script>
    const domainBtns = document.querySelectorAll(".domain-btn");
    const digiLanding = document.querySelector(".digi-health-landing");

    const currentMood = document.getElementById("mood_slider");
    const displayMood = document.getElementById("display_mood");

    const currentSleep = document.getElementById("sleep_slider");
    const displaySleep = document.getElementById("display_sleep");

    const currentNutrition = document.getElementById("nutrition_slider");
    const displayNutrition = document.getElementById("display_nutrition")

    const currentSocial = document.getElementById("social_slider");
    const displaySocial = document.getElementById("display_social");

    const currentExercise = document.getElementById("exercise_slider");
    const displayExercise = document.getElementById("display_exercise");
    const containers = document.querySelectorAll(".domain");
    const sliders = document.querySelectorAll(".slider");
    const sliderDisplay = document.querySelectorAll(".slider-display")

    const startBtn = document.getElementById("start_quiz");
    const nextBtns = document.querySelectorAll(".next-btn");

    const dashBoard = document.querySelector('.dashboard-container');
    const resultContainer = document.querySelector('.result-container');
    const suggestions = document.querySelector('.suggestions');

    const moodResult = document.getElementById('mood_result');
    const sleepResult = document.getElementById('sleep_result');
    const nutritionResult = document.getElementById('nutrition_result');
    const socialResult = document.getElementById('social_result');
    const exerciseResult = document.getElementById('exercise_result');

    const lowScoringAlert = document.getElementById('low_scoring')
    const highScoringAlert = document.getElementById('high_scoring')
    const moodSuggestions = document.getElementById('mood_suggestions')
    const sleepSuggestions = document.getElementById('sleep_suggestions')
    const nutritionSuggestions = document.getElementById('nutrition_suggestions')
    const socialSuggestions = document.getElementById('social_suggestions')
    const exerciseSuggestions = document.getElementById('exercise_suggestions')

    const moodIcon = document.getElementById('mood_icon');
    const sleepIcon = document.getElementById('sleep_icon');
    const nutritionIcon = document.getElementById('nutrition_icon');
    const socialIcon = document.getElementById('social_icon');
    const exerciseIcon = document.getElementById('exercise_icon');
  

    let scoresObject = {};
    let lowScoring = [];
    let highScoring = [];


    startBtn.addEventListener("click", () => {
      [...containers][0].classList.remove("hidden");
      digiLanding.style.display = "none"


    });

    domainBtns.forEach(btn => {
      btn.addEventListener("click", (event) =>{
        let domainPrefix = event.target.id;
        containers.forEach(container => {
          let containerClass = container.classList[0];
          if(containerClass.includes(domainPrefix)){
            container.classList.remove("hidden")
          }
          else{container.classList.add("hidden")}
          })  
      }) 
    });

    nextBtns.forEach(btn => {
      btn.addEventListener("click", (event) => {
        let chosenValue = event.target.parentNode.firstElementChild.value
        let sliderType = event.target.parentNode.firstElementChild.name
        scoresObject[sliderType] = chosenValue
        containers.forEach((container, index) => {
          let containerClass = container.classList[0]
          if(containerClass.includes(btn.parentElement.parentNode.classList[0]) && index < 4){
            [...containers][index + 1].classList.remove("hidden");
            [...containers][index].classList.add("hidden");   
          }
          if(containerClass.includes(btn.parentElement.parentNode.classList[0]) && index === 4){
            //hide slider containers
            [...containers][index].classList.add("hidden"); 

            //reveal results dashboard and suggestions
            dashBoard.classList.remove("hidden");
            resultContainer.classList.remove("hidden");
            suggestions.classList.remove("hidden");
            moodResult.innerHTML = `Mood score: ${scoresObject.mood_slider}`;
            sleepResult.innerHTML = `Sleep score: ${scoresObject.sleep_slider}`;
            nutritionResult.innerHTML = `Nutrition score: ${scoresObject.nutrition_slider}`;
            socialResult.innerHTML = `Social score: ${scoresObject.social_slider}`;
            exerciseResult.innerHTML = `Exercise score: ${scoresObject.exercise_slider}`;

            showPositiveIcon(scoresObject.mood_slider, moodIcon)
            showPositiveIcon(scoresObject.sleep_slider, sleepIcon)
            showPositiveIcon(scoresObject.nutrition_slider, nutritionIcon)
            showPositiveIcon(scoresObject.social_slider, socialIcon)
            showPositiveIcon(scoresObject.exercise_slider, exerciseIcon)

            let scoreEntries = Object.entries(scoresObject)
            scoreEntries.forEach(entry => {
              let breakIndex = entry[0].indexOf('_')
              let domain = entry[0].slice(0,breakIndex)
              if(entry[1] < 5){
                lowScoring.push(domain)
                revealSuggestion(domain)
              }
              if(entry[1] > 5){
                highScoring.push(domain)
                welldoneMsg(domain)

              }
            })

            //If all scores are 5's
            if(lowScoring.length === 0 && highScoring.length === 0 ){
            highScoringAlert.innerHTML = "All 5's! Straight down the middle is a good the place to be, so no suggestions this week!"
            }
    

            //generate suggestion text based on score values
            generateSuggestionText()

            document.documentElement.style.setProperty("--moodbar-width", `${scoresObject.mood_slider * 10}%`);
            document.documentElement.style.setProperty("--sleepbar-width", `${scoresObject.sleep_slider * 10}%`);
            document.documentElement.style.setProperty("--nutritionbar-width", `${scoresObject.nutrition_slider * 10}%`);
            document.documentElement.style.setProperty("--socialbar-width", `${scoresObject.social_slider * 10}%`);
            document.documentElement.style.setProperty("--exercisebar-width", `${scoresObject.exercise_slider * 10}%`);
          }
        })
      })
    })


    function generateSuggestionText (){
      let area = lowScoring.length > 1 ? 'domains' : 'domain';
      let lowDomains = lowScoring.join('+');

      if(lowDomains){
      lowScoringAlert.innerHTML = `It looks like next week you could do with working on the ${[lowDomains]} ${area} of health!
      Follow the links for some great resources that can help boost your health
      and wellbeing`}
      
    }

    function welldoneMsg(domain){
      let area = highScoring.length > 1 ? 'domains' : 'domain';
      let pastTense = highScoring.length > 1 ? 'have' : 'has';
      let highDomains = highScoring.join('+');
      if(highDomains){
        highScoringAlert.innerHTML = `It's great to see that your ${highDomains} ${area} of health ${pastTense} been good this week, keep it going!!`
      }
    }

    function revealSuggestion(domain){
              if(domain === 'mood'){
                moodSuggestions.classList.remove('hidden')
              }
              else if(domain === 'sleep'){
                sleepSuggestions.classList.remove('hidden')
              }
              else if(domain === 'nutrition'){
                nutritionSuggestions.classList.remove('hidden')
              }
              else if(domain === 'social'){
                socialSuggestions.classList.remove('hidden')
              }
              else if (domain === 'exercise'){
                exerciseSuggestions.classList.remove('hidden')
              }
            }

    function showPositiveIcon(sliderScore, iconType){
      if(sliderScore > 5){
        iconType.classList.remove("hidden")
      }}

    //for keyboard users wanting to use 'Enter' instead of tabbing to button
    document.addEventListener("keydown", (event) => {
      if(event.key === 'Enter'){
        let currBtn = [...nextBtns].filter(btn => btn.offsetParent !== null)[0]
        currBtn.click()
      }
    })
  
    document.addEventListener("keydown", (event) => {
      sliders.forEach((slider) => {
        let containerClass = slider.parentElement.parentElement.classList[0];
        if (!containerClass.includes("hidden")) {
          slider.value = event.key;
          sliderDisplay.forEach((score) => {
            if (containerClass.includes(score.id.slice(8))) {
              score.innerHTML = scoreAndWord(slider.value);
            }
          });
        }
      });
    });


    currentMood.addEventListener("input", () => {
      displayMood.innerHTML = scoreAndWord(currentMood.value)
    })

    currentSleep.addEventListener("input", () => {
      displaySleep.innerHTML = scoreAndWord(currentSleep.value)
    })

    currentNutrition.addEventListener("input", () => {
      displayNutrition.innerHTML = scoreAndWord(currentNutrition.value)
    })

    currentSocial.addEventListener("input", () => {
      displaySocial.innerHTML = scoreAndWord(currentSocial.value)
    })

    currentExercise.addEventListener("input", () => {
      displayExercise.innerHTML = scoreAndWord(currentExercise.value)
    })
    

    function scoreAndWord(score){
      wordEquiv = ["", "the worst it could be", "extremely bad", "very bad", "bad", "Ok", "good", "very good", "excellent", "the best it could be"] 
      return `Score: <b>${score}</b> (${wordEquiv[score]})`
    }

  </script>
  </body>
</html>
